"0","tree_plot <- ggtree(firmicutes_subset_tree, layout = ""slanted"", aes(alpha = label %in% closest_ref_leaves, color = label %in% closest_ref_leaves)) +"
"0","# geom_tiplab(aes(subset= label %in% closest_ref_leaves), size = 2, align = TRUE, offset = -0.5) +"
"0","  scale_color_manual(values = c(""grey"", ""black"")) +"
"0","  scale_alpha_manual(values = c(0.2, 1)) +"
"0","  guides(color = ""none"", alpha = ""none"") +"
"0","  geom_treescale(x = 0.09, y = 300, width = 0.5, fontsize = 4, color = ""darkgray"") +"
"0","  "
"0","  # reference leaf label"
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Gordonibacter_pamelaeae__GrdPame5""), label = 'paste(italic(""Gordonibacter pamelaeae""))', parse = T, fontsize = 4, offset = 0.0) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Gordonibacter_pamelaeae_7-10-1-b__FP929047""), label = 'paste(italic(""Gordonibacter pamelaeae""))', parse = T, fontsize = 4, offset = 0.0) +"
"0",""
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfitibacter_alkalitolerans__DfiAlka2""), label = 'paste(italic(""Desulfitibacter alkalitolerans""))', parse = T, fontsize = 4, offset = -.01) +"
"0",""
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfitobacterium_hafniense_Y51__DsfHaf15""), label = 'paste(italic(""Desulfitobacterium hafniense""))', parse = T, fontsize = 4, offset = 0.0) +"
"0",""
"0","    geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfitobacterium_sp._PCE-1__DstSpe13""), label = 'paste(italic(""Desulfitobacterium ""), ""spp."")', parse = T, fontsize = 4, offset = -0.75) +"
"0",""
"0","    geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfosporosinus_youngiae__DfpYoun5""), label = 'paste(italic(""Desulfosporosinus youngiae""))', parse = T, fontsize = 4, offset = 0) +"
"0",""
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Thermodesulfobium_narugense__CP002690""), label = 'paste(italic(""Thermodesulfobium narugense""))', parse = T, fontsize = 4, offset = 0)"
"0",""
"0","unclassified_bacteria <- c(""Anaerobic_bacterium_sk.prop8__Bv2Prop2"", ""Anaerobic_bacterium_EtOH8__Bv2EtOH2"", ""MSW_digester_clone__Unc01cxc"", ""Deep_sea_sediment_clone__JN798931"", ""Bioreactor_clone__UncS2029"", ""Pearl_river_estuary_clone_TopDSR14__UncS2036"", ""Arctic_sediment_clone_AH5_5__AtcSed67"", ""Polluted_aquifer_clone_LGWK16__UncS1633"")"
"0","  "
"0","for (node in unclassified_bacteria) {"
"0","  tree_plot <- tree_plot +  geom_cladelabel(node = MRCA(firmicutes_subset_tree, node), label = ""*"", fontsize = 5, offset = 0)"
"0","}"
