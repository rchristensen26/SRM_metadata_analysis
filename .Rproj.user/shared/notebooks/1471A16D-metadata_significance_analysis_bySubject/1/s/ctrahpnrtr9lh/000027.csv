"0","# use Fischer test"
"0","# it's the nonparametric equivalent of the two-proportion Z test"
"0",""
"0","# contigency_table <- table(hgm_subject_df$bin_5yrCutoff, hgm_subject_df$SRM_present)"
"0","# fisher.test(contigency_table)"
"0",""
"0","# now add significance layer to plot"
"0","# data <- subset(hgm_subject_df, !is.na(hgm_subject_df$bin_5yrCutoff))"
"0",""
"0","# ggplot(data = data, aes(x = bin_5yrCutoff, fill = SRM_present)) +"
"0","# geom_bar(position = ""fill"", alpha = 0.8) +"
"0","# xlab(""Age Bin (years)"") +"
"0","# ggtitle(""Proportion of SRM-Present Subjects by Age, Binned at 5 y.o."") +"
"0","#   ylab(""Proportion"") +"
"0","#   theme_bw() +"
"0","#   geom_text(aes(label = signif((..count.. / tapply(..count.., ..x.., sum)[as.character(..x..)]), digits = 3)), stat = ""count"", position = ""fill"", vjust = 1.6, size = 4) +"
"0","#   scale_fill_manual(values = c(""cornflowerblue"", ""darkorange""), name = ""dsrAB Detected"") +"
"0","#   guides(alpha = ""none"") +"
"0","#   geom_signif(comparisons = list(c(""[0,5)"", ""[5,110)"")), test = ""fisher.test"", aes(y = stat(count/sum(count))))"
"0",""
"0","data %>%"
"0","    group_by(x = bin_5yrCutoff) %>%"
"0","    count(y = SRM_present) %>%"
"0","    # mutate(Freq = n / sum(n)) %>%"
"0","    ggplot() +"
"0","    aes(x, n, fill = y) +"
"0","    geom_col(position = position_dodge(0.9)) +"
"0","    geom_signif("
"0","        comparisons = list(c(""[0,5)"", ""[5,110)"")),"
"0","        map_signif_level = TRUE, test = ""fisher.test"""
"0","    )"
"0",""
