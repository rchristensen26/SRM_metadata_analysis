"0","print(paste(""number of unique subject_ids (after adding project info): "", length(unique(df$merged_subject_id))))"
"1","[1]"
"1"," ""number of unique subject_ids (after adding project info):  4229"""
"1","
"
"0","# set leaf-level OTU names"
"0","OTU_names <- colnames(df[11:45])"
"0","OTU_names <- append(OTU_names, colnames(df[146:158]))"
"0","OTU_names <- append(OTU_names, colnames(df[448:454]))"
"0",""
"0","# make empty df with column names from original df"
"0","hgm_subject_df <- data.frame(matrix(nrow = 0, ncol = ncol(df)))"
"0","colnames(hgm_subject_df) <- colnames(df)"
"0",""
"0","# iterate over rows in original df and add rows with subject ID's one at a time"
"0","for (n_row in 1:nrow(df)) "
"0","  {"
"0","  # check that there is a value for subject id"
"0","  if (!is.na(df[n_row, ""merged_subject_id""])) "
"0","    {"
"0","    subject_id <- as.character(df[n_row, ""merged_subject_id""])"
"0","    subject_ids_in_subjectdf <- as.vector(hgm_subject_df$merged_subject_id)"
"0","    # add row to hgm_subject_df if subject id isn't already in there"
"0","    if (!subject_id %in% subject_ids_in_subjectdf)"
"0","      {"
"0","      hgm_subject_df <- rbind(hgm_subject_df, df[n_row,])"
"0","    }"
"0","    # if subject id already in df, append sample_id to sample_id column and iterate over OTU names (retain TRUE)"
"0","    else if (subject_id %in% subject_ids_in_subjectdf)"
"0","      {"
"0","      sampleIDs_in_subjectdf <- as.vector(hgm_subject_df$sample_id[hgm_subject_df$merged_subject_id == subject_id])"
"0","      new_sample_id <- as.character(df[n_row, ""sample_id""])"
"0","      sample_ids <- append(sampleIDs_in_subjectdf, new_sample_id)"
"0",""
"0","      hgm_subject_df$sample_id[hgm_subject_df$merged_subject_id == subject_id] <- toString(sample_ids)"
"0","      # retain TRUE (""1"") values for OTUs"
"0","      for (OTU in OTU_names) {"
"0","        # check that OTU = 1 in original df"
"0","        if (df[n_row, OTU] == 1) {"
"0","          # check that OTU = 0 in subject df"
"0","          row_number = which(hgm_subject_df$merged_subject_id == subject_id)"
"0","          if (hgm_subject_df[row_number, OTU] == 0) {"
"0","            # change OTU 0 --> 1 in subject df"
"0","            # hgm_subject_df[,OTU][hgm_subject_df$merged_subject_id == df[n_row, ""merged_subject_id""]] <- 1"
"0","            hgm_subject_df[row_number, OTU] <- 1"
"0","          }"
"0","        }"
"0","      }"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","# sanity check?"
"0",""
"0","print(paste(""number of rows in subject df: "", nrow(hgm_subject_df)))"
"1","[1]"
"1"," ""number of rows in subject df:  4228"""
"1","
"
