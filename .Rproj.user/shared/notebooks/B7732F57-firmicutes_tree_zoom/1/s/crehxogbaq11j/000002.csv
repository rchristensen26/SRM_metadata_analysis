"0","# using viewClade function"
"0","# firmicutes_node <- MRCA(tree, ""Gordonibacter_pamelaeae__GrdPame5"", ""Polluted_aquifer_clone_LGWK16__UncS1633"")"
"0","# tree_plot <- ggtree(tree) +"
"0","#   geom_tiplab(aes(subset= label %in% closest_ref_leaves), size = 2, align = TRUE)"
"0","# viewClade(tree_plot, firmicutes_node)"
"0",""
"0","# using tree_subset function"
"0","# firmicutes_subset_tree <- tree_subset(tree, ""Gordonibacter_pamelaeae__GrdPame5"", levels_back = 7)"
"0","# firmicutes_subset_tree <- tree_subset(tree, firmicutes_node, levels_back = 0)"
"0","# ggtree(firmicutes_subset_tree, layout = ""circular"") +"
"0","#   geom_tiplab(aes(subset= label %in% closest_ref_leaves), size = 2, align = TRUE)"
"0","# ggtree(firmicutes_subset_tree) +"
"0","#   geom_tiplab(aes(subset= label %in% closest_ref_leaves), size = 2, align = TRUE)"
"0","# gordonibacter_pamaleae_node <- MRCA(tree, ""Gordonibacter_pamelaeae__GrdPame5"", ""Gordonibacter_pamelaeae_7-10-1-b__FP929047"")"
"0","# tree_plot %>% collapse(node = 1883)"
"0",""
"0","# collapse Desulfitibacter alkalitolerans surrounding node to viz half of firmicutes tree"
"0","# upperFirmNode <- MRCA(firmicutes_subset_tree, ""Desulfitibacter_alkalitolerans__DfiAlka2"", ""QUERY___S233"")"
"0","tree_plot <- ggtree(firmicutes_subset_tree, layout = ""slanted"", aes(color = label %in% closest_ref_leaves)) +"
"0","# geom_tiplab(aes(subset= label %in% closest_ref_leaves), size = 2, align = TRUE, offset = -0.5) +"
"0","  scale_color_manual(values = c(""grey"", ""green"")) +"
"0","  guides(color = ""none"") +"
"0","  "
"0","  # reference leaf labels"
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Gordonibacter_pamelaeae__GrdPame5""), label = 'paste(italic(""Gordonibacter pamelaeae""))', parse = T, fontsize = 4, color = ""green"", offset = 0.1) +"
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Gordonibacter_pamelaeae_7-10-1-b__FP929047""), label = 'paste(italic(""Gordonibacter pamelaeae""))', parse = T, fontsize = 4, color = ""green"", offset = 0.1) +"
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfitibacter_alkalitolerans__DfiAlka2""), label = 'paste(italic(""Desulfitibacter alkalitolerans""))', parse = T, fontsize = 4, color = ""green"", offset = 0.1) +"
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfitobacterium_hafniense_Y51__DsfHaf15""), label = 'paste(italic(""Desulfitobacterium hafniense""))', parse = T, fontsize = 4, color = ""green"", offset = 0.1) +"
"0","    geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfitobacterium_sp._PCE-1__DstSpe13""), label = 'paste(italic(""Desulfitobacterium ""), ""spp."")', parse = T, fontsize = 4, color = ""green"", offset = 0.1) +"
"0","    geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Desulfosporosinus_youngiae__DfpYoun5""), label = 'paste(italic(""Desulfosporosinus youngiae""))', parse = T, fontsize = 4, color = ""green"", offset = 0.1) +"
"0","  geom_cladelabel(node = MRCA(firmicutes_subset_tree, ""Thermodesulfobium_narugense__CP002690""), label = 'paste(italic(""Thermodesulfobium narugense""))', parse = T, fontsize = 4, color = ""green"", offset = 0.1)"
"0","    "
"0",""
"0","unclassified_bacteria <- c(""Anaerobic_bacterium_sk.prop8__Bv2Prop2"", ""Anaerobic_bacterium_EtOH8__Bv2EtOH2"", ""MSW_digester_clone__Unc01cxc"", ""Deep_sea_sediment_clone__JN798931"", ""Bioreactor_clone__UncS2029"", ""Pearl_river_estuary_clone_TopDSR14__UncS2036"", ""Arctic_sediment_clone_AH5_5__AtcSed67"", ""Polluted_aquifer_clone_LGWK16__UncS1633"")"
"0","  "
"0","for (node in unclassified_bacteria) {"
"0","  tree_plot <- tree_plot +  geom_cladelabel(node = MRCA(firmicutes_subset_tree, node), label = ""unclassified bacteria"", fontsize = 3, offset = 0.3)"
"0","}"
"0","  "
"0",""
"0","# tree_plot %>%"
"0","#   collapse(node = upperFirmNode) +"
"0","#   geom_point2(aes(subset=(node==upperFirmNode)), shape=23, size=2, fill='blue') "
"0",""
"0","# tree_plot_allLabels <- ggtree(firmicutes_subset_tree, layout = ""circular"") +"
"0","# geom_tiplab(size = 2, align = TRUE)"
"0","# tree_plot_allLabels %>%"
"0","#   collapse(node = upperFirmNode) +"
"0","#   geom_point2(aes(subset=(node==upperFirmNode)), shape=23, size=3, fill='red')"
"0",""
"0","# viewClade(tree_plot, upperFirmNode)"
"0",""
"0","tree_plot"
