"0",""
"0","# rooted_ref_tree = ape::reaDesulfovibriotree(""/Users/rebeccachristensen/Desktop/Cremer_Lab_2022/main/workflow/out/raxmlOutputFinal/RAxML_originalLabelledTree_noBootstrap.newick"")"
"0","# "
"0","# # # only keep tips that have hits"
"0","# hits_list <- as.vector(otu_hits_table$Var1)"
"0",""
"0","hits_only_tree <- keep.tip(rooted_ref_tree, c(hits_list, ox_bact_node, nitrospirae, red_arch_node))"
"0",""
"0","# hits_only_tree <- ggtree(hits_only_tree) + geom_tiplab(aes(subset=(label %in% otus_to_label)), size = 2) + xlim_tree(15)"
"0","# hits_only_tree <- ggtree(hits_only_tree) + geom_tiplab(aes(subset=(grepl(""Desulfovibrio"", label)) == TRUE), size = 2) + xlim_tree(15)"
"0",""
"0","hits_only_tree <- ggtree(hits_only_tree, color = ""dark gray"") + xlim_tree(10)"
"0",""
"0",""
"0","tree <- hits_only_tree %>%"
"0","  # collapse and label oxidative bacterial node"
"0","  collapse(node = MRCA(hits_only_tree, ox_bact_node)) %>%"
"0","  collapse(node = MRCA(hits_only_tree, red_arch_node)) %>%"
"0","  collapse(node = MRCA(hits_only_tree, nitrospirae)) +"
"0","  "
"0","  # outgroup labels"
"0","  "
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, ox_bact_node))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ox_bact_node), label = ""oxidative bacterial type dsrAB"", fontsize = 2, color = ""dark gray"") +"
"0","  "
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, nitrospirae))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, nitrospirae), label = ""nitrospirae supercluster"", fontsize = 2, color = ""dark gray"") +"
"0","  "
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, red_arch_node))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, red_arch_node), label = ""reductive archaeal type dsrAB"", fontsize = 2, color = ""dark gray"") + "
"0","  "
"0","  # geom_point2(aes(subset=(node == MRCA(hits_only_tree, ""Moorella_thermoacetica_Y72_copy_2__MooTher5""))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  # geom_cladelabel(node = MRCA(hits_only_tree, ""Moorella_thermoacetica_Y72_copy_2__MooTher5""), label = ""Moorella thermoacetica, dsrAB copy 2"", fontsize = 2, offset.text = 0.3, color = ""dark gray"") +"
"0","  "
"0","  # species labels"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, bilophila_node), label = ""Bilophila spp."", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dpiger_node), label = ""Desulfovibrio piger"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dalkalitolerans_node), label = ""Desulfitibacter alkalitolerans"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, gpam_node), label = ""Gordonibacter pamelaeae"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dvulgaris_node), label = ""Desulfovibrio vulgaris"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dcarboniphilus_node), label = ""Desulfovibrio carboniphilus"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, tnarugense_node), label = ""Thermodesulfobium narugense"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, archaeoglobus_node), label = ""Archaeoglobus sulfaticallidus"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, desulfitobacterium_node), label = ""Desulfitobacterium"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_simplex__DslSimpl""), label = ""Desulfovibrio simplex"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Candidatus_Desulfovibrio_trichonymphae""), label = ""Candidatus Desulfovibrio trichonymphae"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfosporosinus_youngiae__DfpYoun5""), label = ""Desulfosporosinus youngiae"", fontsize = 2) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, c(""Desulfovibrio_sp._6_1_46AFAA__DsvSp231"", ""Desulfovibrio_sp._3_1_syn3__DsvSp230"", ""Desulfovibrio_sp._Dsv1__DsvSp233"")), label = ""Desulfovibrio spp."", fontsize = 2) +"
"0","  "
"0","  # Desulfovibrio desulfuricans labels"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_desulfuricans__DQ092635""), label = ""Desulfovibrio desulfuricans"", fontsize = 2) +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, c(""Desulfovibrio_desulfuricans__DslDes17"", ""Desulfovibrio_desulfuricans_subsp._desulfuricans_str._ATCC_27774__CP001358"")), label = ""Desulfovibrio desulfuricans"", fontsize = 2) +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_desulfuricans__DslDes16_DsvAlas8""), label = ""Desulfovibrio desulfuricans"", fontsize = 2) +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_desulfuricans__DslDes24""), label = ""Desulfovibrio desulfuricans"", fontsize = 2) +"
"0",""
"0","  # group labels"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, firmicutes_node), label = ""Firmicutes group sensu lato"", fontsize = 4, offset = 3) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, desulfovibrionaceae_node), label = ""Desulfovibrionaceae"", fontsize = 4, offset = 2) +"
"0","  "
"0","    geom_cladelabel(node = MRCA(hits_only_tree, firmicutes_node), label = """", fontsize = 4, offset = 3) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, desulfovibrionaceae_node), label = """", fontsize = 4, offset = 2)"
"0",""
"0",""
"0","tree %<+%"
"0","  otu_all_table +"
"0","  geom_point2(aes(color = updated_freq, subset = Freq > 0)) +"
"0","  scale_color_gradient(low = ""blue"", high = ""orange"") +"
"0","  # guides(color = ""none"") +"
"0","  theme(legenDesulfovibrioposition = ""left"")"
"1","[1m[33mError[39m:[22m
[33m![39m Theme element `legenDesulfovibrioposition` is not defined in the element hierarchy.
Backtrace:
[90m 1. [39m[1mbase[22m (local) `<fn>`(x)
[90m 2. [39mggplot2:::print.ggplot(x)
[90m 4. [39mggplot2:::ggplot_gtable.ggplot_built(data)
[90m 5. [39mggplot2:::plot_theme(plot)
[90m 6. [39m[1mbase[22m::mapply(validate_element, theme, names(theme), MoreArgs = list(element_tree = get_element_tree()))
[90m 7. [39mggplot2 (local) [38;5;232m[1m[94m`<fn>`([38;5;232m[22m[39mdots[[1L]][[94L]], dots[[2L]][[94L]], element_tree = `<named list>`[38;5;232m[1m[94m)[38;5;232m[22m[39m
"
