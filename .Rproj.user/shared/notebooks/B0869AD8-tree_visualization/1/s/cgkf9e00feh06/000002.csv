"0","hits_only_tree <- keep.tip(rooted_ref_tree, c(hits_list, ox_bact_node, nitrospirae, red_arch_node))"
"0","hits_only_tree <- ggtree(hits_only_tree) + xlim_tree(15) + geom_tiplab(size = 2, offset = 0.3)"
"0",""
"0","tree <- hits_only_tree %>%"
"0","  # collapse and label oxidative bacterial node"
"0","  collapse(node = MRCA(hits_only_tree, ox_bact_node)) %>%"
"0","  collapse(node = MRCA(hits_only_tree, red_arch_node)) %>%"
"0","  collapse(node = MRCA(hits_only_tree, nitrospirae)) +"
"0","  "
"0","  # outgroup labels"
"0","  "
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, ox_bact_node))), shape = 21, fill = ""gray"", color = ""gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ox_bact_node), label = ""oxidative bacterial type dsrAB"", fontsize = 2, color = ""gray"", offset = 0.3) +"
"0","  "
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, nitrospirae))), shape = 21, fill = ""gray"", color = ""gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, nitrospirae), label = ""nitrospirae supercluster"", fontsize = 2, color = ""gray"", offset = 0.3) +"
"0","  "
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, red_arch_node))), shape = 21, fill = ""gray"", color = ""gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, red_arch_node), label = ""reductive archaeal type dsrAB"", fontsize = 2, color = ""gray"", offset = 0.3) +"
"0","  "
"0","  # group labels"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, firmicutes_node), label = ""Firmicutes group"", fontsize = 4, offset = 5.5, alpha = 0.5) +"
"0","  "
"0","  geom_cladelabel(node = MRCA(hits_only_tree, desulfovibrionaceae_node), label = ""Desulfovibrionaceae"", fontsize = 4, offset = 4.5, alpha = 0.5)"
"0",""
"0","tree %<+%"
"0","  otu_all_table +"
"0","  geom_point2(aes(color = logFreq, subset = updated_freq > 0)) +"
"0","  scale_color_gradient(low = ""blue"", high = ""orange"") +"
"0","  # guides(color = ""none"", size = ""none"") +"
"0","  theme(legend.position = ""left"")"
"0",""
