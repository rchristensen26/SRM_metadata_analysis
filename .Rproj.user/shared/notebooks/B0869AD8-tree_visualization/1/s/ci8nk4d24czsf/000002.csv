"0",""
"0","# rooted_ref_tree = ape::read.tree(""/Users/rebeccachristensen/Desktop/Cremer_Lab_2022/main/workflow/out/raxmlOutputFinal/RAxML_originalLabelledTree_noBootstrap.newick"")"
"0","# "
"0","# # # only keep tips that have hits"
"0","hits_list <- as.vector(otu_hits_table$Var1)"
"0",""
"0","hits_only_tree <- keep.tip(rooted_ref_tree, c(hits_list, ox_bact_node, nitrospirae, red_arch_node))"
"0",""
"0","# hits_only_tree <- ggtree(hits_only_tree) + geom_tiplab(aes(subset=(label %in% otus_to_label)), size = 2) + xlim_tree(15)"
"0","# hits_only_tree <- ggtree(hits_only_tree) + geom_tiplab(aes(subset=(grepl(""Desulfovibrio"", label)) == TRUE), size = 2) + xlim_tree(15)"
"0",""
"0","hits_only_tree <- ggtree(hits_only_tree, color = ""dark gray"") + xlim_tree(10)"
"0",""
"0",""
"0","tree <- hits_only_tree %>%"
"0","  # collapse and label oxidative bacterial node"
"0","  collapse(node = MRCA(hits_only_tree, ox_bact_node)) %>%"
"0","  collapse(node = MRCA(hits_only_tree, red_arch_node)) %>%"
"0","  collapse(node = MRCA(hits_only_tree, nitrospirae)) +"
"0",""
"0","  # outgroup labels"
"0",""
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, ox_bact_node))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ox_bact_node), label = ""oxidative bacterial type dsrAB"", fontsize = 2.5, color = ""dark gray"") +"
"0",""
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, nitrospirae))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, nitrospirae), label = ""nitrospirae supercluster"", fontsize = 2.5, color = ""dark gray"") +"
"0",""
"0","  geom_point2(aes(subset=(node == MRCA(hits_only_tree, red_arch_node))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, red_arch_node), label = ""reductive archaeal type dsrAB"", fontsize = 2.5, color = ""dark gray"") +"
"0",""
"0","  # geom_point2(aes(subset=(node == MRCA(hits_only_tree, ""Moorella_thermoacetica_Y72_copy_2__MooTher5""))), shape = 21, fill = ""dark gray"", color = ""dark gray"") +"
"0","  # geom_cladelabel(node = MRCA(hits_only_tree, ""Moorella_thermoacetica_Y72_copy_2__MooTher5""), label = ""Moorella thermoacetica, dsrAB copy 2"", fontsize = 2.5, offset.text = 0.3, color = ""dark gray"") +"
"0",""
"0","  # species labels"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, bilophila_node), label = 'paste(italic(""Bilophila""), "" spp.* 59.7%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dpiger_node), label = 'paste(italic(""Desulfovibrio piger""), ""* 16.9%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dalkalitolerans_node), label = 'paste(italic(""Desulfitibacter alkalitolerans""), "" 11.8%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, gpam_node), label = 'paste(italic(""Gordonibacter pamelaeae""), ""* 6.5%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dvulgaris_node), label = 'paste(italic(""Desulfovibrio vulgaris""), ""* 4.0%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, dcarboniphilus_node), label = 'paste(italic(""Desulfovibrio carboniphilus""), "" <1%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, tnarugense_node), label = 'paste(italic(""Thermodesulfobium narugense""), "" 1.2%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, archaeoglobus_node), label = 'paste(italic(""Archaeoglobus sulfaticallidus""), "" 1.3%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, desulfitobacterium_node), label = 'paste(italic(""Desulfitobacterium hafniense""), "" <1%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_simplex__DslSimpl""), label = 'paste(italic(""Desulfovibrio simplex""), "" <1%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Candidatus_Desulfovibrio_trichonymphae""), label = 'paste(italic(""Candidatus""), "" Desulfovibrio trichonymphae <1%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfosporosinus_youngiae__DfpYoun5""), label = 'paste(italic(""Desulfosporosinus youngiae""), "" <1%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, c(""Desulfovibrio_sp._6_1_46AFAA__DsvSp231"", ""Desulfovibrio_sp._3_1_syn3__DsvSp230"", ""Desulfovibrio_sp._Dsv1__DsvSp233"")), label = 'paste(italic(""Desulfovibrio""), "" spp. 3.8%"")', parse = T, fontsize = 2.5) +"
"0",""
"0","  # Desulfovibrio desulfuricans labels"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_desulfuricans__DQ092635""), label = 'paste(italic(""Desulfovibrio desulfuricans*""), "" <1%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, c(""Desulfovibrio_desulfuricans__DslDes17"", ""Desulfovibrio_desulfuricans_subsp._desulfuricans_str._ATCC_27774__CP001358"")), label = 'paste(italic(""Desulfovibrio desulfuricans*""), "" <1%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_desulfuricans__DslDes16_DsvAlas8""), label = 'paste(italic(""Desulfovibrio desulfuricans*""), "" <1%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0","  geom_cladelabel(node = MRCA(hits_only_tree, ""Desulfovibrio_desulfuricans__DslDes24""), label = 'paste(italic(""Desulfovibrio desulfuricans*""), "" <1%"")', parse = T, fontsize = 2.5, color = ""black"") +"
"0",""
"0","  # group labels"
"0",""
"0","  # geom_cladelabel(node = MRCA(hits_only_tree, firmicutes_node), label = ""Firmicutes group s.l. "", fontsize = 2.5, offset = 4, horizontal = FALSE) +"
"0","  #"
"0","  # geom_cladelabel(node = MRCA(hits_only_tree, desulfovibrionaceae_node), label = ""Desulfovibrionaceae"", fontsize = 2.5, offset = 3, horizontal = FALSE)"
"0",""
"0","    geom_cladelabel(node = MRCA(hits_only_tree, firmicutes_node), label = """", fontsize = 2.5, offset = 4, horizontal = FALSE) +"
"0",""
"0","  geom_cladelabel(node = MRCA(hits_only_tree, desulfovibrionaceae_node), label = """", fontsize = 2.5, offset = 3, horizontal = FALSE)"
"0",""
"0",""
"0","# tree %<+%"
"0","#   otu_all_table +"
"0","#   geom_point2(aes(color = logFreq, subset = Freq > 0)) +"
"0","#   scale_color_gradient(low = ""orange"", high = ""blue"") +"
"0","#   # guides(color = ""none"") +"
"0","#   theme(legend.position = ""left"")"
"0",""
"0",""
