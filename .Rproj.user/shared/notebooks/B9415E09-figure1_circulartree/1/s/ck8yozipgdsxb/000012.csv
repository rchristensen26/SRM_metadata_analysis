"0","# prepare taxonomy table"
"0","# rownames(taxa_table) <- taxa_table$OTU"
"0","# taxa_table <- as.matrix(taxa_table)"
"0","# taxa_table <- taxa_table[,-c(1:2)]"
"0","# TAX = tax_table(taxa_table)"
"0","# dummy otu_table"
"0","# ref_otu_matrix <- matrix(data = 1, nrow = nrow(taxa_table))"
"0","# rownames(ref_otu_matrix) <- rownames(taxa_table)"
"0","# colnames(ref_otu_matrix) <- c(""sample1"")"
"0","# OTU = otu_table(ref_otu_matrix, taxa_are_rows = TRUE)"
"0","#"
"0",""
"0","# hit_otus <- unique(subset(closestRefInfo_allScoreThresholdHits_singleRefOnly$closest_single_ref, closestRefInfo_allScoreThresholdHits_singleRefOnly$distance < 2.5 & !is.na(closestRefInfo_allScoreThresholdHits_singleRefOnly$closest_single_ref)))"
"0","# hit_otus <- gsub(""[.]"", ""-"", hit_otus)"
"0","# hit_otus <- gsub(""sp-"", ""sp."", hit_otus)"
"0","# hit_otus <- gsub(""sk-"", ""sk."", hit_otus)"
"0","# hit_otus <- gsub(""str-"", ""str."", hit_otus)"
"0","# hit_otus"
"0","# "
"0","# # hits_list <- as.vector(otu_hits_table$Var1)"
"0","# hits_list <- hit_otus"
"0","# hits_only_tree <- keep.tip(pruned_tree, c(hits_list))"
"0","# phylotree <- phyloseq(TAX, OTU, hits_only_tree)"
"0","# # "
"0","# plot_tree(phylotree)"
"0","# "
"0","# desulfovibrionaceae_node <- intersect(as.vector(subset(taxa_table$OTU, taxa_table$level3_taxon == ""Desulfovibrionaceae"")), pruned_tree$tip.label)"
"0","# "
"0","desulfovibrionaceae_tax <- subset_taxa(TAX, level3_taxon == ""Desulfovibrionaceae"")"
"0","# "
"0","desulfovibrionaceae_tree <- phyloseq(desulfovibrionaceae_tax, OTU, hits_only_tree)"
"0",""
"0",""
"0","# plot_tree(tip_glom(phylotree, h = 0), label.tips = ""taxa_names"", text.size = 2)"
"0",""
"0","# desulfovibrionnaceae_tree_clustered <- tip_glom(desulfovibrionaceae_tree, h = 0)"
"0",""
"0","plot_tree(tip_glom(desulfovibrionaceae_tree, h = 0), label.tips = ""taxa_names"", text.size = 2)"
