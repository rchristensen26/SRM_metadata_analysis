"0","# library(RColorBrewer)"
"0","tree <- ggtree(pruned_tree, layout = ""circular"", size = 0.15) +"
"0","  theme(plot.title = element_text(hjust = 0.5, size = 13), legend.title = element_text(hjust = 0.5, size = 8))"
"0",""
"0","taxa <- as.vector(unique(taxa_table$supercluster))"
"0",""
"0","deltaproteobacteria_node <- c(""Desulfobacca_acetoxidans__DebAcet3"", ""Desulfovibrio_magneticus__AP010904"")"
"0",""
"0","colors <- brewer.pal(6, ""Set2"")"
"0","n = 1"
"0",""
"0","for (taxon in taxa) {"
"0","  if (!is.na(taxon) & taxon != ""Deltaproteobacteria supercluster"") {"
"0",""
"0","    node <- intersect(as.vector(subset(taxa_table$OTU, taxa_table$supercluster == taxon)), pruned_tree$tip.label)"
"0",""
"0","  if ((length(node) > 0)) {"
"0",""
"0","    tree <- tree +"
"0","      # geom_hilight(node = MRCA(pruned_tree, node), color = colors[n], alpha = 0) +"
"0","      geom_cladelab(node = MRCA(pruned_tree, node), label = taxon, fontsize = 2, horizontal = F, hjust = 0.5, vjust = 1.5, barcolor = colors[n], align = T)"
"0","    "
"0","    n = n +1"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","tree <- tree + "
"0","      # geom_hilight(node = MRCA(pruned_tree, deltaproteobacteria_node), color = colors[n], alpha = 0) +"
"0","      geom_cladelab(node = MRCA(pruned_tree, deltaproteobacteria_node), label = ""Deltaproteobacteria supercluster"", fontsize = 2, horizontal = F, hjust = 0.5, vjust = 1.5, barcolor = colors[n], align = T) +"
"0","  "
"0","  # geom_hilight(node = MRCA(pruned_tree, red_arch_node), color = colors[n+1], alpha = 0) +"
"0","      geom_cladelab(node = MRCA(pruned_tree, red_arch_node), label = ""reductive archaeal type DsrAB"", fontsize = 2, horizontal = F, hjust = 0.5, vjust = 1.5, barcolor = colors[n+1], align = T)"
"0",""
"0","tree"
